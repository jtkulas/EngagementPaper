Item_13=`I devote my full attention to my work tasks throughout the day.`,
Item_14=`Thinking about work saps my energy.`,
Item_15=`I would rather direct my focus toward a work task than a personal task.`,
Item_16=`I’m able to maintain good levels of energy throughout the workday.`,
Item_17=`I enjoy spending time completing my job tasks.`,
Item_18=`Most days I feel enthusiastic about starting my work day.`,
Item_19=`I feel motivated to go beyond what is asked of me.`,
Item_20=`This job drains my energy.`,
Item_21=`When work is slow I find ways to be productive.`,
Item_22=`I express enthusiasm for my job while at work.`,
Item_23=`I try my best to perform well at work.`,
Item_24=`If I notice my energy level is low, I take corrective steps to re-energize.`,
Item_25=`I plan my future with this company.`,
Item_26=`I believe this company cares about my career goals.`,
Item_27=`I often think about finding another job.`,
Item_28=`This organization challenges me to work at my full potential.`,
Item_29=`I am proud to be a member of this organization.`,
Item_30=`I feel supported by my supervisor when I fail at a task.`,
Item_31=`I feel proud of my accomplishments within this organization.`,
Item_32=`My job makes me feel like I’m part of something meaningful.`,
Item_33=`I make valued contributions to the organization.`,
Item_34=`I embrace challenging situations at work.`,
Item_35=`I speak positively about this organization to others.`,
Item_36=`This organization provides the resources necessary for me to successfully perform my job.`
) %>%
select(Item_1,Item_2,Item_3,Item_4,Item_5,Item_6,Item_7,Item_8,Item_9,Item_10,Item_11,Item_12,Item_13,Item_14,Item_15,Item_16,Item_17,
Item_18,Item_19,Item_20,Item_21,Item_22,Item_23,Item_24,Item_25,Item_26,Item_27,Item_28,Item_29,Item_30,Item_31,Item_32,Item_33,
Item_34,Item_35,Item_36)
# Condition 3 _________________________________________________________________________________________
Cond3_Model<-cond3.red[,2:37]
Cond3_Model<-Cond3_Model%>%rename(
Item_1=`I’m able to concentrate on my work without distractions.`,
Item_2=`I have a hard time detaching mentally from my work.`,
Item_3=`Time passes quickly while I’m working.`,
Item_4=`I find it difficult to mentally disconnect from work.`,
Item_5=`I enjoy thinking about work even when I’m not at work.`,
Item_6=`Most days, I feel happiest when the workday is soon to be complete.`,
Item_7=`I am happiest when I am immersed in a project.`,
Item_8=`I love starting my workday.`,
Item_9=`I devote more time than is expected of me.`,
Item_10=`I have to be reminded to take breaks while I’m at work.`,
Item_11=`I never miss a work deadline.`,
Item_12=`I never allow distractions to interfere with my work.`,
Item_13=`I devote my full attention to my work tasks throughout the day.`,
Item_14=`Thinking about work saps my energy.`,
Item_15=`I would rather direct my focus toward a work task than a personal task.`,
Item_16=`I’m able to maintain good levels of energy throughout the workday.`,
Item_17=`I enjoy spending time completing my job tasks.`,
Item_18=`Most days I feel enthusiastic about starting my work day.`,
Item_19=`I feel motivated to go beyond what is asked of me.`,
Item_20=`This job drains my energy.`,
Item_21=`When work is slow I find ways to be productive.`,
Item_22=`I express enthusiasm for my job while at work.`,
Item_23=`I try my best to perform well at work.`,
Item_24=`If I notice my energy level is low, I take corrective steps to re-energize.`,
Item_25=`I plan my future with this company.`,
Item_26=`I believe this company cares about my career goals.`,
Item_27=`I often think about finding another job.`,
Item_28=`This organization challenges me to work at my full potential.`,
Item_29=`I am proud to be a member of this organization.`,
Item_30=`I feel supported by my supervisor when I fail at a task.`,
Item_31=`I feel proud of my accomplishments within this organization.`,
Item_32=`My job makes me feel like I’m part of something meaningful.`,
Item_33=`I make valued contributions to the organization.`,
Item_34=`I embrace challenging situations at work.`,
Item_35=`I speak positively about this organization to others.`,
Item_36=`This organization provides the resources necessary for me to successfully perform my job.`
) %>%
select(Item_1,Item_2,Item_3,Item_4,Item_5,Item_6,Item_7,Item_8,Item_9,Item_10,Item_11,Item_12,Item_13,Item_14,Item_15,Item_16,Item_17,
Item_18,Item_19,Item_20,Item_21,Item_22,Item_23,Item_24,Item_25,Item_26,Item_27,Item_28,Item_29,Item_30,Item_31,Item_32,Item_33,
Item_34,Item_35,Item_36)
# Condition 4 _________________________________________________________________________________________
Cond4_Model<-cond4.red[,2:37]
Cond4_Model<-Cond4_Model%>%rename(
Item_1=`I’m able to concentrate on my work without distractions.`,
Item_2=`I have a hard time detaching mentally from my work.`,
Item_3=`Time passes quickly while I’m working.`,
Item_4=`I find it difficult to mentally disconnect from work.`,
Item_5=`I enjoy thinking about work even when I’m not at work.`,
Item_6=`Most days, I feel happiest when the workday is soon to be complete.`,
Item_7=`I am happiest when I am immersed in a project.`,
Item_8=`I love starting my workday.`,
Item_9=`I devote more time than is expected of me.`,
Item_10=`I have to be reminded to take breaks while I’m at work.`,
Item_11=`I never miss a work deadline.`,
Item_12=`I never allow distractions to interfere with my work.`,
Item_13=`I devote my full attention to my work tasks throughout the day.`,
Item_14=`Thinking about work saps my energy.`,
Item_15=`I would rather direct my focus toward a work task than a personal task.`,
Item_16=`I’m able to maintain good levels of energy throughout the workday.`,
Item_17=`I enjoy spending time completing my job tasks.`,
Item_18=`Most days I feel enthusiastic about starting my work day.`,
Item_19=`I feel motivated to go beyond what is asked of me.`,
Item_20=`This job drains my energy.`,
Item_21=`When work is slow I find ways to be productive.`,
Item_22=`I express enthusiasm for my job while at work.`,
Item_23=`I try my best to perform well at work.`,
Item_24=`If I notice my energy level is low, I take corrective steps to re-energize.`,
Item_25=`I plan my future with this company.`,
Item_26=`I believe this company cares about my career goals.`,
Item_27=`I often think about finding another job.`,
Item_28=`This organization challenges me to work at my full potential.`,
Item_29=`I am proud to be a member of this organization.`,
Item_30=`I feel supported by my supervisor when I fail at a task.`,
Item_31=`I feel proud of my accomplishments within this organization.`,
Item_32=`My job makes me feel like I’m part of something meaningful.`,
Item_33=`I make valued contributions to the organization.`,
Item_34=`I embrace challenging situations at work.`,
Item_35=`I speak positively about this organization to others.`,
Item_36=`This organization provides the resources necessary for me to successfully perform my job.`
) %>%
select(Item_1,Item_2,Item_3,Item_4,Item_5,Item_6,Item_7,Item_8,Item_9,Item_10,Item_11,Item_12,Item_13,Item_14,Item_15,Item_16,Item_17,
Item_18,Item_19,Item_20,Item_21,Item_22,Item_23,Item_24,Item_25,Item_26,Item_27,Item_28,Item_29,Item_30,Item_31,Item_32,Item_33,
Item_34,Item_35,Item_36)
# Reneta's 18-Items______________________________________________________
### Getting all together
Cond1_Model$Cond <- "Cond1"
Cond2_Model$Cond <- "Cond2"
Cond3_Model$Cond <- "Cond3"
Cond4_Model$Cond <- "Cond4"
SIOPmi <- as.data.frame(rbind(Cond1_Model,Cond2_Model,Cond3_Model,Cond4_Model))
######################################################################
######################################################################
####################### New data 10/12
newdata.att <- read.csv("Qualtrics/Engagement+(Attitudinal)_October+12,+2021_08.02.csv")[47:66]
newdata.sub <- read.csv("Qualtrics/Engagement+(Substantive)_October+12,+2021_08.01.csv")[47:66]
newdata.att <- newdata.att[-c(1:2),]
newdata.sub <- newdata.sub[-c(1:2),]
names(newdata.att) <- c("Item_1","Item_3","Item_4","Item_14","Item_16","Item_25","Item_26","Item_28","Item_5","Item_8","Item_17","Item_19","Item_31","Item_32","Item_10","Item_11","Item_21","Item_22","Item_34","Item_35")
names(newdata.sub) <- c("Item_1","Item_3","Item_4","Item_5","Item_8","Item_10","Item_11","Item_14","Item_16","Item_17","Item_19","Item_21","Item_22","Item_25","Item_26","Item_28","Item_31","Item_32","Item_34","Item_35")
use.att <- newdata.att[,c(1,2,9,10,15,16,4,5,11,12,17,18,7,8,13,14,19,20)]
use.sub <- newdata.sub[,-c(3,14)]
use.att$Cond <- "Cond5"
use.sub$Cond <- "Cond6"
siop.pilot <- SIOPmi[,c(1,3,5,8,10,11,14,16,17,19,21,22,26,28,31,32,34,35,37)]
siop <- as.data.frame(rbind(siop.pilot,use.att,use.sub))
siop$Item_1 <- as.numeric(as.character(siop$Item_1))
siop$Item_3 <- as.numeric(as.character(siop$Item_3))
siop$Item_5 <- as.numeric(as.character(siop$Item_5))
siop$Item_8 <- as.numeric(as.character(siop$Item_8))
siop$Item_10 <- as.numeric(as.character(siop$Item_10))
siop$Item_11 <- as.numeric(as.character(siop$Item_11))
siop$Item_14 <- as.numeric(as.character(siop$Item_14))
siop$Item_16 <- as.numeric(as.character(siop$Item_16))
siop$Item_17 <- as.numeric(as.character(siop$Item_17))
siop$Item_19 <- as.numeric(as.character(siop$Item_19))
siop$Item_21 <- as.numeric(as.character(siop$Item_21))
siop$Item_22 <- as.numeric(as.character(siop$Item_22))
siop$Item_26 <- as.numeric(as.character(siop$Item_26))
siop$Item_28 <- as.numeric(as.character(siop$Item_28))
siop$Item_31 <- as.numeric(as.character(siop$Item_31))
siop$Item_32 <- as.numeric(as.character(siop$Item_32))
siop$Item_34 <- as.numeric(as.character(siop$Item_34))
siop$Item_35 <- as.numeric(as.character(siop$Item_35))
siop$Item_14 <- 7-siop$Item_14
abs <- psych::alpha(siop[c(1:6)])
vig <- psych::alpha(siop[c(7:12)])
ded <- psych::alpha(siop[c(13:18)])
aff <- psych::alpha(siop[c(1:2,7:8,13:14)])
cog <- psych::alpha(siop[c(3:4,9:10,15:16)])
beh <- psych::alpha(siop[c(5:6,11:12,17:18)])
## Looks like Casey recoded in raw data, but this is "together" object that isn't really used. Old data looks fine (snowball sample) - new data actually looks crappy (no attention to recoded items)
papaja::apa_table(read.csv("items.csv"), # apa contains the data.frame needed for apa_table
caption = "Focal items and their scale associations",
landscape = FALSE,
escape = F)
library(lavaan)
substantive <-'
Absorption=~Item_1 + Item_3  + Item_5  + Item_8  + Item_10 + Item_11
Vigor=~Item_14 + Item_16 + Item_17 + Item_19 + Item_21 + Item_22
Dedication=~Item_26 + Item_28 + Item_31 + Item_32 + Item_34 + Item_35
'
fullsub <- lavaan::cfa(substantive, data = siop); plotfullsub <- fullsub
fullsub <- as.data.frame(fitMeasures(fullsub))
fullsub$rounded <- round(fullsub$`fitMeasures(fullsub)`,2)
t.fullsub <- fullsub %>%
select(Substantive=rounded)
t.fullsub <- as.data.frame(t(t.fullsub[c(3,4,5,23,29,9,10,19),]))        ## Chi-sq, df, RMSEA, SRMR, CFI, TLI, AIC
attiduinal <-'
Cognitive=~Item_1+Item_3+ Item_14 + Item_16 + Item_26 + Item_28
Affective=~Item_5+Item_8+ Item_17 + Item_19 + Item_31 + Item_32
Behavioral=~Item_10+Item_11 + Item_21 + Item_22 + Item_34 + Item_35
'
fullatt <- lavaan::cfa(attiduinal, data = siop); plotfullatt <- fullatt
fullatt <- as.data.frame(fitMeasures(fullatt))
fullatt$rounded <- round(fullatt$`fitMeasures(fullatt)`,2)
semPlot::semPaths(plotfullsub,what="std", sizeLat=10, style="lisrel",
sizeMan=4.5,edge.label.cex=0.75, edge.color="black", asize=2, rotation=2)
semPlot::semPaths(plotfullatt,what="std", sizeLat=10, style="lisrel",
sizeMan=4.5,edge.label.cex=0.75, edge.color="black", asize=2, rotation=2)
cond1sub <- lavaan::cfa(substantive, data = Cond1_Model)
cond1sub <- as.data.frame(fitMeasures(cond1sub))
cond1sub$rounded <- round(cond1sub$`fitMeasures(cond1sub)`,2)
t.cond1sub <- cond1sub %>%
select(Substantive=rounded)
t.cond1sub <- as.data.frame(t(t.cond1sub[c(3,4,5,23,29,9,10,19),]))
cond1att <- lavaan::cfa(attiduinal, data = Cond1_Model)
cond1att <- as.data.frame(fitMeasures(cond1att))
cond1att$rounded <- round(cond1att$`fitMeasures(cond1att)`,2)
cond2sub <- lavaan::cfa(substantive, data = Cond2_Model)
cond2sub <- as.data.frame(fitMeasures(cond2sub))
cond2sub$rounded <- round(cond2sub$`fitMeasures(cond2sub)`,2)
cond2att <- lavaan::cfa(attiduinal, data = Cond2_Model)
cond2att <- as.data.frame(fitMeasures(cond2att))
cond2att$rounded <- round(cond2att$`fitMeasures(cond2att)`,2)
cond3sub <- lavaan::cfa(substantive, data = Cond3_Model)
cond3sub <- as.data.frame(fitMeasures(cond3sub))
cond3sub$rounded <- round(cond3sub$`fitMeasures(cond3sub)`,2)
cond3att <- lavaan::cfa(attiduinal, data = Cond3_Model)
cond3att <- as.data.frame(fitMeasures(cond3att))
cond3att$rounded <- round(cond3att$`fitMeasures(cond3att)`,2)
cond4sub <- lavaan::cfa(substantive, data = Cond4_Model)
cond4sub <- as.data.frame(fitMeasures(cond4sub))
cond4sub$rounded <- round(cond4sub$`fitMeasures(cond4sub)`,2)
cond4att <- lavaan::cfa(attiduinal, data = Cond4_Model)
cond4att <- as.data.frame(fitMeasures(cond4att))
cond4att$rounded <- round(cond4att$`fitMeasures(cond4att)`,2)
cond5 <- siop[ which(siop$Cond=='Cond5'), ]
cond5sub <- lavaan::cfa(substantive, data = cond5)
cond5sub <- as.data.frame(fitMeasures(cond5sub))
cond5sub$rounded <- round(cond5sub$`fitMeasures(cond5sub)`,2)
cond5att <- lavaan::cfa(attiduinal, data = cond5)
cond5att <- as.data.frame(fitMeasures(cond5att))
cond5att$rounded <- round(cond5att$`fitMeasures(cond5att)`,2)
cond6 <- siop[ which(siop$Cond=='Cond6'), ]
cond6sub <- lavaan::cfa(substantive, data = cond6)
cond6sub <- as.data.frame(fitMeasures(cond6sub))
cond6sub$rounded <- round(cond6sub$`fitMeasures(cond6sub)`,2)
cond6att <- lavaan::cfa(attiduinal, data = cond6)
cond6att <- as.data.frame(fitMeasures(cond6att))
cond6att$rounded <- round(cond6att$`fitMeasures(cond6att)`,2)
siop$Absorption <- rowMeans(siop[c(1:6)], na.rm=TRUE)
siop$Vigor <- rowMeans(siop[c(7:12)], na.rm=TRUE)
siop$Dedication <- rowMeans(siop[c(13:18)], na.rm=TRUE)
siop$Affect <- rowMeans(siop[c(1:2,7:8,13:14)], na.rm=TRUE)
siop$Cognition <- rowMeans(siop[c(3:4,9:10,15:16)], na.rm=TRUE)
siop$Behavior <- rowMeans(siop[c(5:6,11:12,17:18)], na.rm=TRUE)
r <- corx::corx(siop[,20:25],                     ## can extend if needed
triangle = "lower",
stars = c(0.05, 0.01, 0.001),
describe = c(`$M$` = mean, `$SD$` = sd))
papaja::apa_table(r$apa, # apa contains the data.frame needed for apa_table
caption = "Unit-weighted scale intercorrelations (all conditions).",
note = "* p < 0.05; ** p < 0.01; *** p < 0.001",
landscape = TRUE,
escape = F)
## https://users.ugent.be/~yrosseel/lavaan/multiplegroup6Dec2012.pdf
pilot <- siop[ which(siop$Cond == 'Cond1' | siop$Cond == 'Cond2' | siop$Cond == 'Cond3' | siop$Cond == 'Cond4'), ]
pilot <- pilot[,c(1:19)]
configural.a <- cfa(model=attiduinal, data=pilot, group="Cond") # configural invariance
weak.a <- cfa(model=attiduinal, data=pilot, group="Cond", group.equal="loadings") # weak invariance
strong.a <- cfa(model=attiduinal, data=pilot, group="Cond", group.equal=c("intercepts", "loadings")) # strong invariance
strict.a <- cfa(model=attiduinal, data=pilot, group="Cond", group.equal=c("loadings", "intercepts", "residuals"))
# summary(configural, fit.measures=TRUE)
## changed above to only adults
fittab <- lavTestLRT(configural.a,weak.a,strong.a, strict.a)
write.csv(fittab, "Tables/groupindicesatt.csv")
#semPlot::semPaths(model1, "std", layout = "tree3",
#                  rotation = 2, curvePivot=TRUE, style="lisrel", nCharNodes = 0)
papaja::apa_table(fittab, # apa contains the data.frame needed for apa_table
caption = "Measurement invariance summary statistics (attitudinal structure).",
note = "* p < 0.05; ** p < 0.01; *** p < 0.001",
landscape = FALSE,
escape = F)
## https://users.ugent.be/~yrosseel/lavaan/multiplegroup6Dec2012.pdf
configural.s <- cfa(model=substantive, data=pilot, group="Cond") # configural invariance
weak.s <- cfa(model=substantive, data=pilot, group="Cond", group.equal="loadings") # weak invariance
strong.s <- cfa(model=substantive, data=pilot, group="Cond", group.equal=c("intercepts", "loadings")) # strong invariance
strict.s <- cfa(model=substantive, data=pilot, group="Cond", group.equal=c("loadings", "intercepts", "residuals"))
# summary(configural, fit.measures=TRUE)
## changed above to only adults
fittab2 <- lavTestLRT(configural.s,weak.s,strong.s, strict.s)
write.csv(fittab2, "Tables/groupindicessub.csv")
#semPlot::semPaths(model1, "std", layout = "tree3",
#                  rotation = 2, curvePivot=TRUE, style="lisrel", nCharNodes = 0)
papaja::apa_table(fittab2, # apa contains the data.frame needed for apa_table
caption = "Measurement invariance summary statistics (substantive structure).",
note = "* p < 0.05; ** p < 0.01; *** p < 0.001",
landscape = FALSE,
escape = F)
## https://users.ugent.be/~yrosseel/lavaan/multiplegroup6Dec2012.pdf
siop2 <- siop[1:19]
configural.a2 <- cfa(model=attiduinal, data=siop2, group="Cond") # configural invariance
weak.a2 <- cfa(model=attiduinal, data=siop2, group="Cond", group.equal="loadings") # weak invariance
strong.a2 <- cfa(model=attiduinal, data=siop2, group="Cond", group.equal=c("intercepts", "loadings")) # strong invariance
strict.a2 <- cfa(model=attiduinal, data=siop2, group="Cond", group.equal=c("loadings", "intercepts", "residuals"))
# summary(configural, fit.measures=TRUE)
## changed above to only adults
fittab3 <- lavTestLRT(configural.a2,weak.a2,strong.a2, strict.a2)
write.csv(fittab3, "Tables/groupindicesatt2.csv")
#semPlot::semPaths(model1, "std", layout = "tree3",
#                  rotation = 2, curvePivot=TRUE, style="lisrel", nCharNodes = 0)
papaja::apa_table(fittab3, # apa contains the data.frame needed for apa_table
caption = "Measurement invariance summary statistics (attitudinal structure [6 conditions]).",
note = "* p < 0.05; ** p < 0.01; *** p < 0.001",
landscape = FALSE,
escape = F)
## https://users.ugent.be/~yrosseel/lavaan/multiplegroup6Dec2012.pdf
configural.s2 <- cfa(model=substantive, data=siop2, group="Cond") # configural invariance
weak.s2 <- cfa(model=substantive, data=siop2, group="Cond", group.equal="loadings") # weak invariance
strong.s2 <- cfa(model=substantive, data=siop2, group="Cond", group.equal=c("intercepts", "loadings")) # strong invariance
strict.s2 <- cfa(model=substantive, data=siop2, group="Cond", group.equal=c("loadings", "intercepts", "residuals"))
# summary(configural, fit.measures=TRUE)
## changed above to only adults
fittab4 <- lavTestLRT(configural.s2,weak.s2,strong.s2, strict.s2)
# Creating tables to show description for each csv sheet we pulled from qualtrics.
t_1 <- data.frame(name_of_sheet = "qualtrics_pilot_data.csv",
num = temp %>% nrow(),
oldest_response = min(temp$end_date),
latest_response = max(temp$end_date),
Sample = "Snowball sample from first go round using 2020 Eagle I.O cohort")
t_2 <- data.frame(name_of_sheet = "Engagement+(Attitudinal)_October+12,+2021_08.02.csv",
num = new.att %>% nrow(),
oldest_response = min(new.att$end_date),
latest_response = max(new.att$end_date),
Sample = "Samples comes from Renata's survey using 5 short measures of work engagement as well as free-time activities (spending time either with pets or game-playing). Ordering our measure using the attitudinal construct")
library("papaja")
r_refs("bibs/r-references.bib")
# Loading packages
library(tidyverse)
library(knitr)
library(strex)
abs <- psych::alpha(siop[c(1:6)])
install.packages("psych")
library("papaja")
r_refs("bibs/r-references.bib")
# Loading packages
library(tidyverse)
library(knitr)
library(strex)
# Seed for random number generation
set.seed(42)
knitr::opts_chunk$set(cache.extra = knitr::rand_seed, warning=FALSE, echo=FALSE, message=FALSE)
## Cleaning Qualtrics construct validation data - 10/14/21
newdata.att <- read.csv("C:\\Kulas\\Git\\EngagementPaper\\Qualtrics\\Engagement+(Attitudinal)_October+12,+2021_08.02.csv"); names <- newdata.att[1,c(1:92)] #[47:66]
newdata.sub <- read.csv("C:\\Kulas\\Git\\EngagementPaper\\Qualtrics\\Engagement+(Substantive)_October+12,+2021_08.01.csv")#[47:66]
newdata.att <- newdata.att[-c(1:2),]                      ## peskies
newdata.sub <- newdata.sub[-c(1:2),]
write.csv(newdata.att, "changingnumerica.csv")
newdata.att <- read.csv("changingnumerica.csv")            ## that worked!!
write.csv(newdata.sub, "changingnumerics.csv")
newdata.sub <- read.csv("changingnumerics.csv")
library(careless)
newdata.att$careless_long <- longstring(newdata.att[20:83])
newdata.sub$careless_long <- longstring(newdata.sub[20:83])
newdata.att$irv <- irv(newdata.att[48:51])
newdata.sub$irv <- irv(newdata.sub[55:58])
newdata.att$irv2 <- irv(newdata.att[25:28])   ## another reverse-score
newdata.sub$irv2 <- irv(newdata.sub[25:28])
## newdata.att$missing <- rowSums(is.na(newdata.att[20:83]))
## newdata.sub$missing <- rowSums(is.na(newdata.sub[20:83]))
#descr::freq(newdata.att$irv2)
#descr::freq(newdata.sub$irv2)
## need filter for non-differentiating reverse-score people
newdata.att$flag <- "use"; newdata.sub$flag <- "use"         ## need to do because subset on lines 44/45 can't != "Flagged"
## upped time to 300 seconds as data still looked bad with 200
newdata.att$flag[newdata.att$careless_long > 12 | newdata.att$Duration..in.seconds. < 300 | newdata.att$irv == 0 | newdata.att$irv2 == 0]  <- "Flagged"
newdata.sub$flag[newdata.sub$careless_long > 12 | newdata.sub$Duration..in.seconds. < 300 | newdata.sub$irv == 0 | newdata.sub$irv2 == 0]  <- "Flagged"
write.csv(newdata.att, "attitudeset.csv")
write.csv(newdata.sub, "substantiveset.csv")
newdata.att$flag <- as.factor(newdata.att$flag)
newdata.sub$flag <- as.factor(newdata.sub$flag)
#descr::freq(newdata.att$flag)
#descr::freq(newdata.sub$flag)
useatt <- newdata.att[ which(newdata.att$flag == "use"), c(1:92)]
usesub <- newdata.sub[ which(newdata.sub$flag == "use"), c(1:92)]
useseb.sorted <- usesub[,c(1:47, 48:50,55:56,61:63,51:52,57:58,64:65,53:54,59:60,66:67,68:92)]
names(useseb.sorted) <- names(useatt)           ##### focal engagement is 48:67
qualtrics <- as.data.frame(rbind(useseb.sorted,useatt))
########################################### Engagement
qualtrics$C14 <- 7-qualtrics$C14
cognition.alpha  <- psych::alpha(qualtrics[c(48:55)])
affect.alpha     <- psych::alpha(qualtrics[c(56:61)])
behavior.alpha   <- psych::alpha(qualtrics[c(62:67)])
absorption.alpha <- psych::alpha(qualtrics[c(48:50,56:57,62:63)])
vigor.alpha      <- psych::alpha(qualtrics[c(51:52,58:59,64:65)])
dedication.alpha <- psych::alpha(qualtrics[c(53:55,60:61,66:67)])
qualtrics$cognition <- rowMeans(qualtrics[c(48:55)], na.rm=TRUE)
qualtrics$affect    <- rowMeans(qualtrics[c(56:61)], na.rm=TRUE)
qualtrics$behavior  <- rowMeans(qualtrics[c(62:67)], na.rm=TRUE)
qualtrics$absorption <- rowMeans(qualtrics[c(48:50,56:57,62:63)], na.rm=TRUE)
qualtrics$vigor      <- rowMeans(qualtrics[c(51:52,58:59,64:65)], na.rm=TRUE)
qualtrics$dedication <- rowMeans(qualtrics[c(53:55,60:61,66:67)], na.rm=TRUE)
# cor(qualtrics[93:98], use="complete.obs")
########################################### Intent to quit
intent.quit.alpha <- psych::alpha(qualtrics[c(80:83)])
qualtrics$intentquit <- rowMeans(qualtrics[c(80:83)], na.rm=TRUE)
########################################### Pets
pets <- psych::alpha(qualtrics[c(75:79)])
qualtrics$pets <- rowMeans(qualtrics[c(75:79)], na.rm=TRUE)
########################################### Household Chores
household <- psych::alpha(qualtrics[c(68:74)])
qualtrics$household <- rowMeans(qualtrics[c(68:74)], na.rm=TRUE)
########################################### Saks
saks.job <- psych::alpha(qualtrics[c(20:24)])
qualtrics$Q8 <- 6 - qualtrics$Q8
saks.work <- psych::alpha(qualtrics[c(25:30)])
qualtrics$saks.job <- rowMeans(qualtrics[c(20:24)], na.rm=TRUE)
qualtrics$saks.work <- rowMeans(qualtrics[c(25:30)], na.rm=TRUE)
########################################### UWES
UWES.vigor      <- psych::alpha(qualtrics[c(31,34,38,42,45,47)])
UWES.dedication <- psych::alpha(qualtrics[c(32,35,37,40,43)])
UWES.absorption <- psych::alpha(qualtrics[c(33,36,39,41,44,46)])
qualtrics$UWES.vigor      <- rowMeans(qualtrics[c(31,34,38,42,45,47)], na.rm=TRUE)
qualtrics$UWES.dedication <- rowMeans(qualtrics[c(32,35,37,40,43)], na.rm=TRUE)
qualtrics$UWES.absorption <- rowMeans(qualtrics[c(33,36,39,41,44,46)], na.rm=TRUE)
items <- read.csv("modification indices KEY - Hopefully Final.csv")  ## without 4
apa_table(
items
, caption = "Suggested final scale definitions."
, escape = TRUE
, landscape = TRUE
, note = "The recommended response scale is 'Strongly Disagree', 'Disagree', 'Somewhat Disagree', 'Somewhat Agree', 'Agree', and 'Strongly Agree'"
)
# cor(qualtrics[93:106], use="complete.obs")
r <- corx::corx(qualtrics[,c(94,95,93,98,96,97,102,103,105,106,104,99,100,101)],                     ## can extend if needed
triangle = "lower",
stars = c(0.05, 0.01, 0.001),
describe = c(`$M$` = mean, `$SD$` = sd))
papaja::apa_table(r$apa, # apa contains the data.frame needed for apa_table
caption = "Unit-weighted scale intercorrelations (all variables).",
note = "* p < 0.05; ** p < 0.01; *** p < 0.001",
landscape = TRUE,
escape = F)
# cor(qualtrics[93:106], use="complete.obs")
new <- qualtrics[,c(94,95,93,98,96,97,102,103,105,106,104,99,100,101)]
new$focal <- rowMeans(new[1:3], na.rm=TRUE)
new$Saks <- rowMeans(new[7:8], na.rm=TRUE)
new$UWES <- rowMeans(new[9:11], na.rm=TRUE)
r <- corx::corx(new[,c(15:17, 12:14)],                     ## can extend if needed
triangle = "lower",
stars = c(0.05, 0.01, 0.001),
describe = c(`$M$` = mean, `$SD$` = sd))
papaja::apa_table(r$apa, # apa contains the data.frame needed for apa_table
caption = "Scale intercorrelations (Overall engagement aggregates).",
note = "* p < 0.05; ** p < 0.01; *** p < 0.001",
landscape = TRUE,
escape = F)
# Importing Data from Qualtrics.
temp <- read.csv("Qualtrics/qualtrics_pilot_data.csv", header=TRUE, na.strings="", skip = 1) %>%
dplyr::slice(-1) %>%
janitor::clean_names()
################ Cleaning up data and combining the four condition into one ################
data <- temp %>%
mutate(Cond1 = rowSums(is.na(temp[18:53])), # Counts how many na's occur between columns 18 to 53. Fix columns if any columns are removed during cleaning process.
Cond2 = rowSums(is.na(temp[54:89])),
Cond3 = rowSums(is.na(temp[90:125])),
Cond4 = rowSums(is.na(temp[126:161]))) %>%
mutate(Condition = case_when(Cond1 < 36 ~ 1, # Determing what is the condition, if they have less than 36 NA, then that is there condition.
Cond2 < 36 ~ 2,
Cond3 < 36 ~ 3,
Cond4 < 36 ~ 4))
# Splitting the Conditions
split.data <- split(data, f = data$Condition)
cond1 <- split.data[["1"]] %>%
select(duration_in_seconds,
matches("c1"), # select columns that only have c1 in the name
what_is_the_title_of_the_job_you_were_thinking_about_while_responding_to_this_survey:any_general_comments_or_reactions_you_d_care_to_share_with_the_scale_development_team,
Condition) %>%
rename_with(~substr(.,6, nchar(.)), # removes the first six characters a text
starts_with("c", ignore.case = FALSE)) # only looks at columns that have a lower case c
cond2 <- split.data[["2"]] %>%
select(duration_in_seconds, matches("c2"), what_is_the_title_of_the_job_you_were_thinking_about_while_responding_to_this_survey:any_general_comments_or_reactions_you_d_care_to_share_with_the_scale_development_team, Condition) %>%
rename_with(~substr(.,6, nchar(.)), starts_with("c", ignore.case = FALSE))
cond3 <- split.data[["3"]] %>%
select(duration_in_seconds, matches("c3"), what_is_the_title_of_the_job_you_were_thinking_about_while_responding_to_this_survey:any_general_comments_or_reactions_you_d_care_to_share_with_the_scale_development_team, Condition) %>%
rename_with(~substr(.,6, nchar(.)), starts_with("c", ignore.case = FALSE))
cond4 <- split.data[["4"]] %>%
select(duration_in_seconds, matches("c4"), what_is_the_title_of_the_job_you_were_thinking_about_while_responding_to_this_survey:any_general_comments_or_reactions_you_d_care_to_share_with_the_scale_development_team, Condition) %>%
rename_with(~substr(.,6, nchar(.)), starts_with("c", ignore.case = FALSE))
# Reranging all columns to be in the same order. Using condition 1 ordering.
col_order <- c("duration_in_seconds", "i_enjoy_thinking_about_work_even_when_i_m_not_at_work", "most_days_i_feel_happiest_when_the_workday_is_soon_to_be_complete", "i_am_happiest_when_i_am_immersed_in_a_project", "i_love_starting_my_workday", "i_enjoy_spending_time_completing_my_job_tasks", "most_days_i_feel_enthusiastic_about_starting_my_work_day", "i_feel_motivated_to_go_beyond_what_is_asked_of_me", "this_job_drains_my_energy", "i_am_proud_to_be_a_member_of_this_organization", "i_feel_supported_by_my_supervisor_when_i_fail_at_a_task", "i_feel_proud_of_my_accomplishments_within_this_organization", "my_job_makes_me_feel_like_i_m_part_of_something_meaningful", "i_devote_more_time_than_is_expected_of_me", "i_have_to_be_reminded_to_take_breaks_while_i_m_at_work", "i_never_miss_a_work_deadline", "i_never_allow_distractions_to_interfere_with_my_work", "when_work_is_slow_i_find_ways_to_be_productive", "i_express_enthusiasm_for_my_job_while_at_work", "i_try_my_best_to_perform_well_at_work", "if_i_notice_my_energy_level_is_low_i_take_corrective_steps_to_re_energize", "i_make_valued_contributions_to_the_organization", "i_embrace_challenging_situations_at_work", "i_speak_positively_about_this_organization_to_others", "this_organization_provides_the_resources_necessary_for_me_to_successfully_perform_my_job", "i_devote_my_full_attention_to_my_work_tasks_throughout_the_day", "thinking_about_work_saps_my_energy", "i_would_rather_direct_my_focus_toward_a_work_task_than_a_personal_task", "i_m_able_to_maintain_good_levels_of_energy_throughout_the_workday", "i_plan_my_future_with_this_company", "i_believe_this_company_cares_about_my_career_goals", "i_often_think_about_finding_another_job", "this_organization_challenges_me_to_work_at_my_full_potential", "i_m_able_to_concentrate_on_my_work_without_distractions", "i_have_a_hard_time_detaching_mentally_from_my_work", "time_passes_quickly_while_i_m_working", "i_find_it_difficult_to_mentally_disconnect_from_work", "what_is_the_title_of_the_job_you_were_thinking_about_while_responding_to_this_survey", "how_many_hours_do_you_typically_work_per_week_in_this_job", "how_long_have_you_been_with_this_organization", "any_general_comments_or_reactions_you_d_care_to_share_with_the_scale_development_team", "Condition")
cond1.red <- cond1[, col_order] # rearrange columns in order to follow condition 1
abs <- psych::alpha(siop[c(1:6)])
# Importing Data from Qualtrics.
temp <- read.csv("Qualtrics/qualtrics_pilot_data.csv", header=TRUE, na.strings="", skip = 1) %>%
dplyr::slice(-1) %>%
janitor::clean_names()
################ Cleaning up data and combining the four condition into one ################
data <- temp %>%
mutate(Cond1 = rowSums(is.na(temp[18:53])), # Counts how many na's occur between columns 18 to 53. Fix columns if any columns are removed during cleaning process.
Cond2 = rowSums(is.na(temp[54:89])),
Cond3 = rowSums(is.na(temp[90:125])),
Cond4 = rowSums(is.na(temp[126:161]))) %>%
mutate(Condition = case_when(Cond1 < 36 ~ 1, # Determing what is the condition, if they have less than 36 NA, then that is there condition.
Cond2 < 36 ~ 2,
Cond3 < 36 ~ 3,
Cond4 < 36 ~ 4))
# Splitting the Conditions
split.data <- split(data, f = data$Condition)
cond1 <- split.data[["1"]] %>%
select(duration_in_seconds,
matches("c1"), # select columns that only have c1 in the name
what_is_the_title_of_the_job_you_were_thinking_about_while_responding_to_this_survey:any_general_comments_or_reactions_you_d_care_to_share_with_the_scale_development_team,
Condition) %>%
rename_with(~substr(.,6, nchar(.)), # removes the first six characters a text
starts_with("c", ignore.case = FALSE)) # only looks at columns that have a lower case c
cond2 <- split.data[["2"]] %>%
select(duration_in_seconds, matches("c2"), what_is_the_title_of_the_job_you_were_thinking_about_while_responding_to_this_survey:any_general_comments_or_reactions_you_d_care_to_share_with_the_scale_development_team, Condition) %>%
rename_with(~substr(.,6, nchar(.)), starts_with("c", ignore.case = FALSE))
cond3 <- split.data[["3"]] %>%
select(duration_in_seconds, matches("c3"), what_is_the_title_of_the_job_you_were_thinking_about_while_responding_to_this_survey:any_general_comments_or_reactions_you_d_care_to_share_with_the_scale_development_team, Condition) %>%
rename_with(~substr(.,6, nchar(.)), starts_with("c", ignore.case = FALSE))
cond4 <- split.data[["4"]] %>%
select(duration_in_seconds, matches("c4"), what_is_the_title_of_the_job_you_were_thinking_about_while_responding_to_this_survey:any_general_comments_or_reactions_you_d_care_to_share_with_the_scale_development_team, Condition) %>%
rename_with(~substr(.,6, nchar(.)), starts_with("c", ignore.case = FALSE))
# Reranging all columns to be in the same order. Using condition 1 ordering.
col_order <- c("duration_in_seconds", "i_enjoy_thinking_about_work_even_when_i_m_not_at_work", "most_days_i_feel_happiest_when_the_workday_is_soon_to_be_complete", "i_am_happiest_when_i_am_immersed_in_a_project", "i_love_starting_my_workday", "i_enjoy_spending_time_completing_my_job_tasks", "most_days_i_feel_enthusiastic_about_starting_my_work_day", "i_feel_motivated_to_go_beyond_what_is_asked_of_me", "this_job_drains_my_energy", "i_am_proud_to_be_a_member_of_this_organization", "i_feel_supported_by_my_supervisor_when_i_fail_at_a_task", "i_feel_proud_of_my_accomplishments_within_this_organization", "my_job_makes_me_feel_like_i_m_part_of_something_meaningful", "i_devote_more_time_than_is_expected_of_me", "i_have_to_be_reminded_to_take_breaks_while_i_m_at_work", "i_never_miss_a_work_deadline", "i_never_allow_distractions_to_interfere_with_my_work", "when_work_is_slow_i_find_ways_to_be_productive", "i_express_enthusiasm_for_my_job_while_at_work", "i_try_my_best_to_perform_well_at_work", "if_i_notice_my_energy_level_is_low_i_take_corrective_steps_to_re_energize", "i_make_valued_contributions_to_the_organization", "i_embrace_challenging_situations_at_work", "i_speak_positively_about_this_organization_to_others", "this_organization_provides_the_resources_necessary_for_me_to_successfully_perform_my_job", "i_devote_my_full_attention_to_my_work_tasks_throughout_the_day", "thinking_about_work_saps_my_energy", "i_would_rather_direct_my_focus_toward_a_work_task_than_a_personal_task", "i_m_able_to_maintain_good_levels_of_energy_throughout_the_workday", "i_plan_my_future_with_this_company", "i_believe_this_company_cares_about_my_career_goals", "i_often_think_about_finding_another_job", "this_organization_challenges_me_to_work_at_my_full_potential", "i_m_able_to_concentrate_on_my_work_without_distractions", "i_have_a_hard_time_detaching_mentally_from_my_work", "time_passes_quickly_while_i_m_working", "i_find_it_difficult_to_mentally_disconnect_from_work", "what_is_the_title_of_the_job_you_were_thinking_about_while_responding_to_this_survey", "how_many_hours_do_you_typically_work_per_week_in_this_job", "how_long_have_you_been_with_this_organization", "any_general_comments_or_reactions_you_d_care_to_share_with_the_scale_development_team", "Condition")
cond1.red <- cond1[, col_order] # rearrange columns in order to follow condition 1
cond1.red <- cond1[, col_order] # rearrange columns in order to follow condition 1
View(cond1)
View(cond1)
